const t=/^ *(#|\/\/)/,e=function(t){let e=t.trim().split(/->/),n=[];e.forEach((t=>{n=n.concat(function(t){if(!(t=t.trim()))return null;if(/^\[/.test(t)&&/\]$/.test(t)){let e=(t=(t=t.replace(/^\[/,"")).replace(/\]$/,"")).split(/,/);return e=e.map((t=>t.trim())).filter((t=>t)),e=e.map((t=>({id:t,children:[],_cache:{}}))),e}return[{id:t,children:[],_cache:{}}]}(t))})),n=n.filter((t=>t));let r=n[0];for(let t=1;t<n.length;t+=1)r.children.push(n[t]),r=n[t];return n[0]},n=function(n=[]){return"string"==typeof n?function(n){let r=n.split(/\r?\n/),i=[];r.forEach((n=>{if(!n.trim()||t.test(n))return;let r=(t=>{const e=/^(  |\t)/;let n=0;for(;e.test(t);)t=t.replace(e,""),n+=1;return n})(n);i.push({indent:r,node:e(n)})}));let c=function(t){let e={children:[]};return t.forEach(((n,r)=>{0===n.indent?e.children=e.children.concat(n.node):t[r-1]&&function(t,e){let n=t[e].indent;for(;e>=0;e-=1)if(t[e].indent<n)return t[e];return t[0]}(t,r).node.children.push(n.node)})),e}(i);return c._cache={parents:0},c}(n):(r=n,"[object Array]"===Object.prototype.toString.call(r)?function(t){let e={};t.forEach((t=>{e[t.id]=t,t.children=t.children||[]}));let n={children:[]};return t.forEach((t=>{t.parent?e.hasOwnProperty(t.parent)?e[t.parent].children.push(t):console.warn(`[Grad] - missing node '${t.parent}'`):n.children.push(t)})),n}(n):n);var r},r={},i=t=>{let e=[],n=[t];for(;n.length>0;){let t=n.pop();t._cache=t._cache||{parents:0},e.push(t),t.children&&t.children.forEach((e=>{e._cache=e._cache||{},e._cache.parents=t._cache.parents+1,n.push(e)}))}return e},c=t=>"[31m"+t+"[0m",l=t=>"[2m"+t+"[0m",s=/\//;class o{constructor(t={}){Object.defineProperty(this,"json",{enumerable:!1,value:t,writable:!0})}get children(){return this.json.children}get label(){return this.json.label}get props(){return this.json.props||{}}set props(t){this.json.props=this.json.props||{};let e=this.json.props;"string"==typeof t&&(e[t]=!0),Object.assign(e,t)}get(t){if(t=(t||"").trim(),!s.test(t)){let e=this.children.find((e=>e.label===t));return new o(e)}let e=function(t,e){let n=function(t){return"string"!=typeof(t=t||"")?t:(t=t.replace(/^\//,"")).split(/\//)}(e);for(let e=0;e<n.length;e+=1){let r=t.children.find((t=>t.label===n[e]));if(!r)return null;t=r}return t}(this,t);return new o(e)}cache(){return i(this.json),this}list(){return i(this.json)}fillDown(){return fillDown(this.json),this}out(){return function(t,e="ascii"){return r.hasOwnProperty(e)?r[e](t):r.ascii(t)}(this.json)}debug(){var t;return t=this.json,i(t).forEach(((t,e)=>{let n=c(t.id||"");(0!==e||t.id)&&console.log("     ".repeat(t._cache.parents)+l("â†’ ")+n)})),this}}const h=function(t){let e=n(t);return new o(e)};h.prototype.plugin=function(t){t(this)};export default h;
